<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Login</title>
		<link rel="stylesheet" href="nav.css">
		<link rel="stylesheet" href="login.css">
	</head>
	<body>  <nav>
        <a href="./index.html">Home</a>
        <a href="./login.html">About</a>
        <a href="./contact.html">Contact</a>
    </nav>
    <form id="login">
            <h1 style=" color: white; padding: 10px;">Login</h1>
			<label for="username" style="display: block; text-align: left; color: white; padding: 10px; font-weight: bold;">Username:</label>
			<input type="text" autocomplete="off" id="username" placeholder="Enter your username" />
		
			<label for="password" style="display: block; text-align: left; color: white; padding: 10px; font-weight: bold;">Password:</label>
			<input type="password" autocomplete="off" id="password" placeholder="Enter your password" />
		
			<input type="submit" value="Submit Form" />
			
        </div> 
        <div class="logouter" > 
            <p1>Logged in</p1>
            <button onclick="logouter();" id="logoutbtn">
                <a href="./login.html">Log Out</a>
            </button>
        </div>
		</form>
		

		<script>  
            const form = document.getElementById('login');
            form.addEventListener('submit', login)
            const logout = document.querySelector('.logouter');
            const logouter = () => {
            logout.style.display = 'none';
            form.style.display = 'flex';
            
        }
            async function login(event) {
            	event.preventDefault()
            	const username = document.getElementById('username').value
            	const password = document.getElementById('password').value
        
            	const result = await fetch('/api/login', {
            		method: 'POST',
            		headers: {
            			'Content-Type': 'application/json'
            		},
            		body: JSON.stringify({
            			username,
            			password
            		})
            	}).then((res) => res.json())
        
            	if (result.status === 'ok') {
            		// everythign went fine
            		logout.style.display = 'flex';
                    form.style.display = 'none';
            		alert('Success')
            	} else {
            		alert(result.error)
            	}
            }
		 
		</script>
	</body>
	</html>
	